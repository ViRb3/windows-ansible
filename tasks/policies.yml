---
- name: Disable automatic Windows Updates
  win_regedit:
    path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU
    name: "{{ item.name }}"
    data: "{{ item.data }}"
    type: "{{ item.type }}"
  loop:
    - { name: "AUOptions", data: "2", type: "dword" }
    - { name: "NoAutoRebootWithLoggedOnUsers", data: "1", type: "dword" }

- name: Disable Windows Update Seeding
  win_regedit:
    path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\DeliveryOptimization
    name: "{{ item.name }}"
    data: "{{ item.data }}"
    type: "{{ item.type }}"
  loop:
    - { name: "DODownloadMode", data: "0", type: "dword" }

# https://pureinfotech.com/disable-timeline-windows-10/
- name: Disable Activity History
  win_regedit:
    path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\System
    name: "{{ item.name }}"
    data: "{{ item.data }}"
    type: "{{ item.type }}"
  loop:
    - { name: "EnableActivityFeed", data: "0", type: "dword" }
    - { name: "PublishUserActivities", data: "0", type: "dword" }
    - { name: "UploadUserActivities", data: "0", type: "dword" }
